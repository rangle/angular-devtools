import { PropType } from 'protocol';
export const getExpandedDirectiveProperties = (data) => {
    const getChildren = (prop) => {
        if ((prop.type === PropType.Object || prop.type === PropType.Array) && prop.value) {
            return Object.keys(prop.value).map(k => {
                return {
                    name: prop.type === PropType.Array ? parseInt(k, 10) : k,
                    children: getChildren(prop.value[k]),
                };
            });
        }
        return [];
    };
    const getExpandedProperties = (props) => {
        return Object.keys(props).map(name => {
            return {
                name,
                children: getChildren(props[name]),
            };
        });
    };
    const parents = {};
    for (const node of data) {
        let prop = node.prop;
        while (prop.parent) {
            prop = prop.parent;
        }
        parents[prop.name] = prop.descriptor;
    }
    return getExpandedProperties(parents);
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvcGVydHktZXhwYW5kZWQtZGlyZWN0aXZlLXByb3BlcnRpZXMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9uZy1kZXZ0b29scy9zcmMvbGliL2RldnRvb2xzLXRhYnMvZGlyZWN0aXZlLWV4cGxvcmVyL3Byb3BlcnR5LXJlc29sdmVyL3Byb3BlcnR5LWV4cGFuZGVkLWRpcmVjdGl2ZS1wcm9wZXJ0aWVzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBMEIsUUFBUSxFQUFFLE1BQU0sVUFBVSxDQUFDO0FBRzVELE1BQU0sQ0FBQyxNQUFNLDhCQUE4QixHQUFHLENBQUMsSUFBZ0IsRUFBZ0IsRUFBRTtJQUMvRSxNQUFNLFdBQVcsR0FBRyxDQUFDLElBQWdCLEVBQUUsRUFBRTtRQUN2QyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksS0FBSyxRQUFRLENBQUMsTUFBTSxJQUFJLElBQUksQ0FBQyxJQUFJLEtBQUssUUFBUSxDQUFDLEtBQUssQ0FBQyxJQUFJLElBQUksQ0FBQyxLQUFLLEVBQUU7WUFDakYsT0FBTyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUU7Z0JBQ3JDLE9BQU87b0JBQ0wsSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJLEtBQUssUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztvQkFDeEQsUUFBUSxFQUFFLFdBQVcsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO2lCQUNyQyxDQUFDO1lBQ0osQ0FBQyxDQUFDLENBQUM7U0FDSjtRQUNELE9BQU8sRUFBRSxDQUFDO0lBQ1osQ0FBQyxDQUFDO0lBRUYsTUFBTSxxQkFBcUIsR0FBRyxDQUFDLEtBQXFDLEVBQUUsRUFBRTtRQUN0RSxPQUFPLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFFO1lBQ25DLE9BQU87Z0JBQ0wsSUFBSTtnQkFDSixRQUFRLEVBQUUsV0FBVyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQzthQUNuQyxDQUFDO1FBQ0osQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUM7SUFFRixNQUFNLE9BQU8sR0FBbUMsRUFBRSxDQUFDO0lBRW5ELEtBQUssTUFBTSxJQUFJLElBQUksSUFBSSxFQUFFO1FBQ3ZCLElBQUksSUFBSSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUM7UUFDckIsT0FBTyxJQUFJLENBQUMsTUFBTSxFQUFFO1lBQ2xCLElBQUksR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDO1NBQ3BCO1FBQ0QsT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDO0tBQ3RDO0lBRUQsT0FBTyxxQkFBcUIsQ0FBQyxPQUFPLENBQUMsQ0FBQztBQUN4QyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBEZXNjcmlwdG9yLCBOZXN0ZWRQcm9wLCBQcm9wVHlwZSB9IGZyb20gJ3Byb3RvY29sJztcbmltcG9ydCB7IEZsYXROb2RlIH0gZnJvbSAnLi9lbGVtZW50LXByb3BlcnR5LXJlc29sdmVyJztcblxuZXhwb3J0IGNvbnN0IGdldEV4cGFuZGVkRGlyZWN0aXZlUHJvcGVydGllcyA9IChkYXRhOiBGbGF0Tm9kZVtdKTogTmVzdGVkUHJvcFtdID0+IHtcbiAgY29uc3QgZ2V0Q2hpbGRyZW4gPSAocHJvcDogRGVzY3JpcHRvcikgPT4ge1xuICAgIGlmICgocHJvcC50eXBlID09PSBQcm9wVHlwZS5PYmplY3QgfHwgcHJvcC50eXBlID09PSBQcm9wVHlwZS5BcnJheSkgJiYgcHJvcC52YWx1ZSkge1xuICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKHByb3AudmFsdWUpLm1hcChrID0+IHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBuYW1lOiBwcm9wLnR5cGUgPT09IFByb3BUeXBlLkFycmF5ID8gcGFyc2VJbnQoaywgMTApIDogayxcbiAgICAgICAgICBjaGlsZHJlbjogZ2V0Q2hpbGRyZW4ocHJvcC52YWx1ZVtrXSksXG4gICAgICAgIH07XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIFtdO1xuICB9O1xuXG4gIGNvbnN0IGdldEV4cGFuZGVkUHJvcGVydGllcyA9IChwcm9wczogeyBbbmFtZTogc3RyaW5nXTogRGVzY3JpcHRvciB9KSA9PiB7XG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKHByb3BzKS5tYXAobmFtZSA9PiB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBuYW1lLFxuICAgICAgICBjaGlsZHJlbjogZ2V0Q2hpbGRyZW4ocHJvcHNbbmFtZV0pLFxuICAgICAgfTtcbiAgICB9KTtcbiAgfTtcblxuICBjb25zdCBwYXJlbnRzOiB7IFtuYW1lOiBzdHJpbmddOiBEZXNjcmlwdG9yIH0gPSB7fTtcblxuICBmb3IgKGNvbnN0IG5vZGUgb2YgZGF0YSkge1xuICAgIGxldCBwcm9wID0gbm9kZS5wcm9wO1xuICAgIHdoaWxlIChwcm9wLnBhcmVudCkge1xuICAgICAgcHJvcCA9IHByb3AucGFyZW50O1xuICAgIH1cbiAgICBwYXJlbnRzW3Byb3AubmFtZV0gPSBwcm9wLmRlc2NyaXB0b3I7XG4gIH1cblxuICByZXR1cm4gZ2V0RXhwYW5kZWRQcm9wZXJ0aWVzKHBhcmVudHMpO1xufTtcbiJdfQ==