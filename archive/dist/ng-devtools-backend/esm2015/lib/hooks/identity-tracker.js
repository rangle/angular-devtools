import { buildDirectiveForest } from '../component-tree';
export class IdentityTracker {
    constructor() {
        this._directiveIdCounter = 0;
        this._currentDirectivePosition = new Map();
        this._currentDirectiveId = new Map();
        this._isComponent = new Map();
    }
    getDirectivePosition(dir) {
        return this._currentDirectivePosition.get(dir);
    }
    getDirectiveId(dir) {
        return this._currentDirectiveId.get(dir);
    }
    hasDirective(dir) {
        return this._currentDirectiveId.has(dir);
    }
    index() {
        const directiveForest = buildDirectiveForest();
        const indexedForest = indexForest(directiveForest);
        const newNodes = [];
        const removedNodes = [];
        const allNodes = new Set();
        indexedForest.forEach((root) => this._index(root, null, newNodes, allNodes));
        this._currentDirectiveId.forEach((_, dir) => {
            if (!allNodes.has(dir)) {
                removedNodes.push({ directive: dir, isComponent: !!this._isComponent.get(dir) });
                // We can't clean these up because during profiling
                // they might be requested for removed components
                // this._currentDirectiveId.delete(dir);
                // this._currentDirectivePosition.delete(dir);
            }
        });
        return { newNodes, removedNodes, indexedForest, directiveForest };
    }
    _index(node, parent, newNodes, allNodes) {
        if (node.component) {
            allNodes.add(node.component.instance);
            this._isComponent.set(node.component.instance, true);
            this._indexNode(node.component.instance, node.position, newNodes);
        }
        (node.directives || []).forEach((dir) => {
            allNodes.add(dir.instance);
            this._isComponent.set(dir.instance, false);
            this._indexNode(dir.instance, node.position, newNodes);
        });
        node.children.forEach((child) => this._index(child, parent, newNodes, allNodes));
    }
    _indexNode(directive, position, newNodes) {
        this._currentDirectivePosition.set(directive, position);
        if (!this._currentDirectiveId.has(directive)) {
            newNodes.push({ directive, isComponent: !!this._isComponent.get(directive) });
            this._currentDirectiveId.set(directive, this._directiveIdCounter++);
        }
    }
    destroy() {
        this._currentDirectivePosition = new Map();
        this._currentDirectiveId = new Map();
    }
}
const indexTree = (node, idx, parentPosition = []) => {
    const position = parentPosition.concat([idx]);
    return {
        position,
        element: node.element,
        component: node.component,
        directives: node.directives.map((d) => (Object.assign({ position }, d))),
        children: node.children.map((n, i) => indexTree(n, i, position)),
        nativeElement: node.nativeElement,
    };
};
export const indexForest = (forest) => forest.map((n, i) => indexTree(n, i));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaWRlbnRpdHktdHJhY2tlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL25nLWRldnRvb2xzLWJhY2tlbmQvc3JjL2xpYi9ob29rcy9pZGVudGl0eS10cmFja2VyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUVBLE9BQU8sRUFBRSxvQkFBb0IsRUFBZ0QsTUFBTSxtQkFBbUIsQ0FBQztBQWN2RyxNQUFNLE9BQU8sZUFBZTtJQUE1QjtRQUNVLHdCQUFtQixHQUFHLENBQUMsQ0FBQztRQUN4Qiw4QkFBeUIsR0FBRyxJQUFJLEdBQUcsRUFBd0IsQ0FBQztRQUM1RCx3QkFBbUIsR0FBRyxJQUFJLEdBQUcsRUFBZSxDQUFDO1FBQzdDLGlCQUFZLEdBQUcsSUFBSSxHQUFHLEVBQWdCLENBQUM7SUFxRWpELENBQUM7SUFuRUMsb0JBQW9CLENBQUMsR0FBUTtRQUMzQixPQUFPLElBQUksQ0FBQyx5QkFBeUIsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDakQsQ0FBQztJQUVELGNBQWMsQ0FBQyxHQUFRO1FBQ3JCLE9BQU8sSUFBSSxDQUFDLG1CQUFtQixDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUMzQyxDQUFDO0lBRUQsWUFBWSxDQUFDLEdBQVE7UUFDbkIsT0FBTyxJQUFJLENBQUMsbUJBQW1CLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQzNDLENBQUM7SUFFRCxLQUFLO1FBTUgsTUFBTSxlQUFlLEdBQUcsb0JBQW9CLEVBQUUsQ0FBQztRQUMvQyxNQUFNLGFBQWEsR0FBRyxXQUFXLENBQUMsZUFBZSxDQUFDLENBQUM7UUFDbkQsTUFBTSxRQUFRLEdBQWMsRUFBRSxDQUFDO1FBQy9CLE1BQU0sWUFBWSxHQUFjLEVBQUUsQ0FBQztRQUNuQyxNQUFNLFFBQVEsR0FBRyxJQUFJLEdBQUcsRUFBTyxDQUFDO1FBQ2hDLGFBQWEsQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJ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aUJBQTJCLEVBQUUsRUFDaEIsRUFBRTtJQUNmLE1BQU0sUUFBUSxHQUFHLGNBQWMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO0lBQzlDLE9BQU87UUFDTCxRQUFRO1FBQ1IsT0FBTyxFQUFFLElBQUksQ0FBQyxPQUFPO1FBQ3JCLFNBQVMsRUFBRSxJQUFJLENBQUMsU0FBUztRQUN6QixVQUFVLEVBQUUsSUFBSSxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLGlCQUFHLFFBQVEsSUFBSyxDQUFDLEVBQUcsQ0FBQztRQUM1RCxRQUFRLEVBQUUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxTQUFTLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxRQUFRLENBQUMsQ0FBQztRQUNoRSxhQUFhLEVBQUUsSUFBSSxDQUFDLGFBQWE7S0FDbkIsQ0FBQztBQUNuQixDQUFDLENBQUM7QUFFRixNQUFNLENBQUMsTUFBTSxXQUFXLEdBQUcsQ0FDekIsTUFBVyxFQUNJLEVBQUUsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUMsU0FBUyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50VHJlZU5vZGUgfSBmcm9tICcuLy4uL2NvbXBvbmVudC10cmVlJztcbmltcG9ydCB7IEVsZW1lbnRQb3NpdGlvbiwgRGV2VG9vbHNOb2RlIH0gZnJvbSAncHJvdG9jb2wnO1xuaW1wb3J0IHsgYnVpbGREaXJlY3RpdmVGb3Jlc3QsIERpcmVjdGl2ZUluc3RhbmNlVHlwZSwgQ29tcG9uZW50SW5zdGFuY2VUeXBlIH0gZnJvbSAnLi4vY29tcG9uZW50LXRyZWUnO1xuaW1wb3J0IHsgVHlwZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuXG5pbnRlcmZhY2UgVHJlZU5vZGUge1xuICBwYXJlbnQ6IFRyZWVOb2RlO1xuICBkaXJlY3RpdmU/OiBUeXBlPGFueT47XG4gIGNoaWxkcmVuOiBUcmVlTm9kZVtdO1xufVxuXG50eXBlIE5vZGVBcnJheSA9IHtcbiAgZGlyZWN0aXZlOiBhbnk7XG4gIGlzQ29tcG9uZW50OiBib29sZWFuO1xufVtdO1xuXG5leHBvcnQgY2xhc3MgSWRlbnRpdHlUcmFja2VyIHtcbiAgcHJpdmF0ZSBfZGlyZWN0aXZlSWRDb3VudGVyID0gMDtcbiAgcHJpdmF0ZSBfY3VycmVudERpcmVjdGl2ZVBvc2l0aW9uID0gbmV3IE1hcDxhbnksIEVsZW1lbnRQb3NpdGlvbj4oKTtcbiAgcHJpdmF0ZSBfY3VycmVudERpcmVjdGl2ZUlkID0gbmV3IE1hcDxhbnksIG51bWJlcj4oKTtcbiAgcHJpdmF0ZSBfaXNDb21wb25lbnQgPSBuZXcgTWFwPGFueSwgYm9vbGVhbj4oKTtcblxuICBnZXREaXJlY3RpdmVQb3NpdGlvbihkaXI6IGFueSk6IEVsZW1lbnRQb3NpdGlvbiB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMuX2N1cnJlbnREaXJlY3RpdmVQb3NpdGlvbi5nZXQoZGlyKTtcbiAgfVxuXG4gIGdldERpcmVjdGl2ZUlkKGRpcjogYW55KTogbnVtYmVyIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5fY3VycmVudERpcmVjdGl2ZUlkLmdldChkaXIpO1xuICB9XG5cbiAgaGFzRGlyZWN0aXZlKGRpcjogYW55KTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuX2N1cnJlbnREaXJlY3RpdmVJZC5oYXMoZGlyKTtcbiAgfVxuXG4gIGluZGV4KCk6IHtcbiAgICBuZXdOb2RlczogTm9kZUFycmF5O1xuICAgIHJlbW92ZWROb2RlczogTm9kZUFycmF5O1xuICAgIGluZGV4ZWRGb3Jlc3Q6IEluZGV4ZWROb2RlW107XG4gICAgZGlyZWN0aXZlRm9yZXN0OiBDb21wb25lbnRUcmVlTm9kZVtdO1xuICB9IHtcbiAgICBjb25zdCBkaXJlY3RpdmVGb3Jlc3QgPSBidWlsZERpcmVjdGl2ZUZvcmVzdCgpO1xuICAgIGNvbnN0IGluZGV4ZWRGb3Jlc3QgPSBpbmRleEZvcmVzdChkaXJlY3RpdmVGb3Jlc3QpO1xuICAgIGNvbnN0IG5ld05vZGVzOiBOb2RlQXJyYXkgPSBbXTtcbiAgICBjb25zdCByZW1vdmVkTm9kZXM6IE5vZGVBcnJheSA9IFtdO1xuICAgIGNvbnN0IGFsbE5vZGVzID0gbmV3IFNldDxhbnk+KCk7XG4gICAgaW5kZXhlZEZvcmVzdC5mb3JFYWNoKChyb290KSA9PiB0aGlzLl9pbmRleChyb290LCBudWxsLCBuZXdOb2RlcywgYWxsTm9kZXMpKTtcbiAgICB0aGlzLl9jdXJyZW50RGlyZWN0aXZlSWQuZm9yRWFjaCgoXzogbnVtYmVyLCBkaXI6IGFueSkgPT4ge1xuICAgICAgaWYgKCFhbGxOb2Rlcy5oYXMoZGlyKSkge1xuICAgICAgICByZW1vdmVkTm9kZXMucHVzaCh7IGRpcmVjdGl2ZTogZGlyLCBpc0NvbXBvbmVudDogISF0aGlzLl9pc0NvbXBvbmVudC5nZXQoZGlyKSB9KTtcbiAgICAgICAgLy8gV2UgY2FuJ3QgY2xlYW4gdGhlc2UgdXAgYmVjYXVzZSBkdXJpbmcgcHJvZmlsaW5nXG4gICAgICAgIC8vIHRoZXkgbWlnaHQgYmUgcmVxdWVzdGVkIGZvciByZW1vdmVkIGNvbXBvbmVudHNcbiAgICAgICAgLy8gdGhpcy5fY3VycmVudERpcmVjdGl2ZUlkLmRlbGV0ZShkaXIpO1xuICAgICAgICAvLyB0aGlzLl9jdXJyZW50RGlyZWN0aXZlUG9zaXRpb24uZGVsZXRlKGRpcik7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHsgbmV3Tm9kZXMsIHJlbW92ZWROb2RlcywgaW5kZXhlZEZvcmVzdCwgZGlyZWN0aXZlRm9yZXN0IH07XG4gIH1cblxuICBwcml2YXRlIF9pbmRleChcbiAgICBub2RlOiBJbmRleGVkTm9kZSxcbiAgICBwYXJlbnQ6IFRyZWVOb2RlIHwgbnVsbCxcbiAgICBuZXdOb2RlczogeyBkaXJlY3RpdmU6IGFueTsgaXNDb21wb25lbnQ6IGJvb2xlYW4gfVtdLFxuICAgIGFsbE5vZGVzOiBTZXQ8YW55PlxuICApOiB2b2lkIHtcbiAgICBpZiAobm9kZS5jb21wb25lbnQpIHtcbiAgICAgIGFsbE5vZGVzLmFkZChub2RlLmNvbXBvbmVudC5pbnN0YW5jZSk7XG4gICAgICB0aGlzLl9pc0NvbXBvbmVudC5zZXQobm9kZS5jb21wb25lbnQuaW5zdGFuY2UsIHRydWUpO1xuICAgICAgdGhpcy5faW5kZXhOb2RlKG5vZGUuY29tcG9uZW50Lmluc3RhbmNlLCBub2RlLnBvc2l0aW9uLCBuZXdOb2Rlcyk7XG4gICAgfVxuICAgIChub2RlLmRpcmVjdGl2ZXMgfHwgW10pLmZvckVhY2goKGRpcikgPT4ge1xuICAgICAgYWxsTm9kZXMuYWRkKGRpci5pbnN0YW5jZSk7XG4gICAgICB0aGlzLl9pc0NvbXBvbmVudC5zZXQoZGlyLmluc3RhbmNlLCBmYWxzZSk7XG4gICAgICB0aGlzLl9pbmRleE5vZGUoZGlyLmluc3RhbmNlLCBub2RlLnBvc2l0aW9uLCBuZXdOb2Rlcyk7XG4gICAgfSk7XG4gICAgbm9kZS5jaGlsZHJlbi5mb3JFYWNoKChjaGlsZCkgPT4gdGhpcy5faW5kZXgoY2hpbGQsIHBhcmVudCwgbmV3Tm9kZXMsIGFsbE5vZGVzKSk7XG4gIH1cblxuICBwcml2YXRlIF9pbmRleE5vZGUoZGlyZWN0aXZlOiBhbnksIHBvc2l0aW9uOiBFbGVtZW50UG9zaXRpb24sIG5ld05vZGVzOiBOb2RlQXJyYXkpOiB2b2lkIHtcbiAgICB0aGlzLl9jdXJyZW50RGlyZWN0aXZlUG9zaXRpb24uc2V0KGRpcmVjdGl2ZSwgcG9zaXRpb24pO1xuICAgIGlmICghdGhpcy5fY3VycmVudERpcmVjdGl2ZUlkLmhhcyhkaXJlY3RpdmUpKSB7XG4gICAgICBuZXdOb2Rlcy5wdXNoKHsgZGlyZWN0aXZlLCBpc0NvbXBvbmVudDogISF0aGlzLl9pc0NvbXBvbmVudC5nZXQoZGlyZWN0aXZlKSB9KTtcbiAgICAgIHRoaXMuX2N1cnJlbnREaXJlY3RpdmVJZC5zZXQoZGlyZWN0aXZlLCB0aGlzLl9kaXJlY3RpdmVJZENvdW50ZXIrKyk7XG4gICAgfVxuICB9XG5cbiAgZGVzdHJveSgpOiB2b2lkIHtcbiAgICB0aGlzLl9jdXJyZW50RGlyZWN0aXZlUG9zaXRpb24gPSBuZXcgTWFwPGFueSwgRWxlbWVudFBvc2l0aW9uPigpO1xuICAgIHRoaXMuX2N1cnJlbnREaXJlY3RpdmVJZCA9IG5ldyBNYXA8YW55LCBudW1iZXI+KCk7XG4gIH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBJbmRleGVkTm9kZSBleHRlbmRzIERldlRvb2xzTm9kZTxEaXJlY3RpdmVJbnN0YW5jZVR5cGUsIENvbXBvbmVudEluc3RhbmNlVHlwZT4ge1xuICBwb3NpdGlvbjogRWxlbWVudFBvc2l0aW9uO1xuICBjaGlsZHJlbjogSW5kZXhlZE5vZGVbXTtcbn1cblxuY29uc3QgaW5kZXhUcmVlID0gPFQgZXh0ZW5kcyBEZXZUb29sc05vZGU8RGlyZWN0aXZlSW5zdGFuY2VUeXBlLCBDb21wb25lbnRJbnN0YW5jZVR5cGU+PihcbiAgbm9kZTogVCxcbiAgaWR4OiBudW1iZXIsXG4gIHBhcmVudFBvc2l0aW9uOiBudW1iZXJbXSA9IFtdXG4pOiBJbmRleGVkTm9kZSA9PiB7XG4gIGNvbnN0IHBvc2l0aW9uID0gcGFyZW50UG9zaXRpb24uY29uY2F0KFtpZHhdKTtcbiAgcmV0dXJuIHtcbiAgICBwb3NpdGlvbixcbiAgICBlbGVtZW50OiBub2RlLmVsZW1lbnQsXG4gICAgY29tcG9uZW50OiBub2RlLmNvbXBvbmVudCxcbiAgICBkaXJlY3RpdmVzOiBub2RlLmRpcmVjdGl2ZXMubWFwKChkKSA9PiAoeyBwb3NpdGlvbiwgLi4uZCB9KSksXG4gICAgY2hpbGRyZW46IG5vZGUuY2hpbGRyZW4ubWFwKChuLCBpKSA9PiBpbmRleFRyZWUobiwgaSwgcG9zaXRpb24pKSxcbiAgICBuYXRpdmVFbGVtZW50OiBub2RlLm5hdGl2ZUVsZW1lbnQsXG4gIH0gYXMgSW5kZXhlZE5vZGU7XG59O1xuXG5leHBvcnQgY29uc3QgaW5kZXhGb3Jlc3QgPSA8VCBleHRlbmRzIERldlRvb2xzTm9kZTxEaXJlY3RpdmVJbnN0YW5jZVR5cGUsIENvbXBvbmVudEluc3RhbmNlVHlwZT4+KFxuICBmb3Jlc3Q6IFRbXVxuKTogSW5kZXhlZE5vZGVbXSA9PiBmb3Jlc3QubWFwKChuLCBpKSA9PiBpbmRleFRyZWUobiwgaSkpO1xuIl19